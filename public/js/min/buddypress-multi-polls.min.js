if("undefined"!=typeof wp&&wp.i18n){let __=wp.i18n.__}($=>{$(document).ready(function(){$(document).on("submit",".wbpoll-form",function(e){e.preventDefault();var $element=$(this);new Pristine($element[0],{classTo:"wbpoll_extra_field_wrap",errorClass:"has-danger",successClass:"has-success",errorTextParent:"wbpoll_extra_field_wrap",errorTextTag:"p",errorTextClass:"text-help"}).validate()?(($element,$)=>{var $submit_btn=$element.find(".wbpoll_vote_btn"),wrapper=$element.closest(".wbpoll_wrapper"),$_this_busy=Number($submit_btn.attr("data-busy")),user_answer=($submit_btn.attr("data-post-id"),$submit_btn.attr("data-reference"),$submit_btn.attr("data-charttype"),$submit_btn.attr("data-security"),$element.find("input.wbpoll_single_answer:checked").serialize());0===$_this_busy&&($submit_btn.attr("data-busy","1"),$submit_btn.prop("disabled",!0),wrapper.find(".wbvoteajaximage").removeClass("wbvoteajaximagecustom"),$_this_busy=user_answer.trim(),void 0!==user_answer&&0!==$_this_busy.length?(wrapper.find(".wbpoll-qresponse").hide(),$.ajax({type:"post",dataType:"json",url:wbpollpublic.ajaxurl,data:$element.serialize()+"&user_answer="+$.base64.btoa(user_answer),success:function(data,textStatus,XMLHttpRequest){if(0===Number(data.error))try{1===data.show_result&&wrapper.append(data.html),wrapper.find(".wbpoll-qresponse").show(),wrapper.find(".wbpoll-qresponse").removeClass("wbpoll-qresponse-alert wbpoll-qresponse-error wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").addClass("wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").html("<p>"+data.text+"</p>"),wrapper.find(".wbpoll_answer_wrapper").hide()}catch(e){}else wrapper.find(".wbpoll-qresponse").show(),wrapper.find(".wbpoll-qresponse").removeClass("wbpoll-qresponse-alert wbpoll-qresponse-error wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").addClass("wbpoll-qresponse-error"),wrapper.find(".wbpoll-qresponse").html("<p>"+data.text+"</p>");$submit_btn.attr("data-busy","0"),$submit_btn.prop("disabled",!1),wrapper.find(".wbvoteajaximage").addClass("wbvoteajaximagecustom")}})):($submit_btn.show(),$submit_btn.attr("data-busy",0),$submit_btn.prop("disabled",!1),wrapper.find(".wbvoteajaximage").addClass("wbvoteajaximagecustom"),$_this_busy=wbpollpublic.no_answer_error,wrapper.find(".wbpoll-qresponse").show(),wrapper.find(".wbpoll-qresponse").removeClass("wbpoll-qresponse-alert wbpoll-qresponse-error wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").addClass("wbpoll-qresponse-alert"),wrapper.find(".wbpoll-qresponse").html($_this_busy)))})($element,$):e.preventDefault()}),$(".poll-image-view").on("click",function(){var dataid=$(this).data("id");$(".lightbox-"+dataid).show()}),$(".close").on("click",function(){var dataid=$(this).data("id");$(".lightbox-"+dataid).hide()}),$(".load-more").on("click",function(){var dataid=$(this).data("id");$(".user-profile-image-modal-"+dataid).show()}),$(".close-profiles").on("click",function(){var dataid=$(this).data("id");$(".user-profile-image-modal-"+dataid).hide()}),$("#text_field").on("click",function(){$("#type_text").show()}),$("#image_field").on("click",function(){$("#type_image").show()}),$("#video_field").on("click",function(){$("#type_video").show()}),$("#audio_field").on("click",function(){$("#type_audio").show()}),$("#html_field").on("click",function(){$("#type_html").show()}),$("#post_text_field").on("click",function(event){event.preventDefault();var event=$('[name="_wbpoll_answer[]"]').map(function(){return $(this).val()}).get(),answertype=$('[name="_wbpoll_answer_extra[][type]"]').map(function(){return $(this).val()}).get(),post_id=$("#post_id").val();$.ajax({url:wbpollpublic.ajaxurl,type:"POST",dataType:"json",data:{action:"wbpoll_additional_field",_wbpoll_answer:event,_wbpoll_answer_extra:answertype,post_id:post_id},success:function(response){location.reload()}})}),$("#post_image_field").on("click",function(event){event.preventDefault();var event=$('[name="_wbpoll_answer[]"]').map(function(){return $(this).val()}).get(),answertype=$('[name="_wbpoll_answer_extra[][type]"]').map(function(){return $(this).val()}).get(),full_size_image_answer=$('[name="_wbpoll_full_size_image_answer[]"]').map(function(){return $(this).val()}).get(),post_id=$("#post_id").val();$.ajax({url:wbpollpublic.ajaxurl,type:"POST",dataType:"json",data:{action:"wbpoll_additional_field_image",_wbpoll_answer:event,_wbpoll_answer_extra:answertype,_wbpoll_full_size_image_answer:full_size_image_answer,post_id:post_id},success:function(response){location.reload()}})}),$("#post_video_field").on("click",function(event){event.preventDefault();var event=$('[name="_wbpoll_answer[]"]').map(function(){return $(this).val()}).get(),answertype=$('[name="_wbpoll_answer_extra[][type]"]').map(function(){return $(this).val()}).get(),video_answer_url=$('[name="_wbpoll_video_answer_url[]"]').map(function(){return $(this).val()}).get(),video_import_info=$('input[name="_wbpoll_video_import_info[]"]:checked').map(function(){return $(this).val()}).get(),post_id=$("#post_id").val();$.ajax({url:wbpollpublic.ajaxurl,type:"POST",dataType:"json",data:{action:"wbpoll_additional_field_video",_wbpoll_answer:event,_wbpoll_answer_extra:answertype,_wbpoll_video_answer_url:video_answer_url,_wbpoll_video_import_info:video_import_info,post_id:post_id},success:function(response){location.reload()}})}),$("#post_audio_field").on("click",function(event){event.preventDefault();var event=$('[name="_wbpoll_answer[]"]').map(function(){return $(this).val()}).get(),answertype=$('[name="_wbpoll_answer_extra[][type]"]').map(function(){return $(this).val()}).get(),audio_answer_url=$('[name="_wbpoll_audio_answer_url[]"]').map(function(){return $(this).val()}).get(),audio_import_info=$('input[name="_wbpoll_audio_import_info[]"]:checked').map(function(){return $(this).val()}).get(),post_id=$("#post_id").val();$.ajax({url:wbpollpublic.ajaxurl,type:"POST",dataType:"json",data:{action:"wbpoll_additional_field_audio",_wbpoll_answer:event,_wbpoll_answer_extra:answertype,_wbpoll_audio_answer_url:audio_answer_url,_wbpoll_audio_import_info:audio_import_info,post_id:post_id},success:function(response){location.reload()}})}),$("#post_html_field").on("click",function(event){event.preventDefault();var event=$('[name="_wbpoll_answer[]"]').map(function(){return $(this).val()}).get(),answertype=$('[name="_wbpoll_answer_extra[][type]"]').map(function(){return $(this).val()}).get(),html_answer=$('[name="_wbpoll_html_answer[]"]').map(function(){return $(this).val()}).get(),post_id=$("#post_id").val();$.ajax({url:wbpollpublic.ajaxurl,type:"POST",dataType:"json",data:{action:"wbpoll_additional_field_html",_wbpoll_answer:event,_wbpoll_answer_extra:answertype,_wbpoll_html_answer:html_answer,post_id:post_id},success:function(response){location.reload()}})})})})(jQuery);