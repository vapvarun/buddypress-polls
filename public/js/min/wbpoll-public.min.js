if("undefined"!=typeof wp&&wp.i18n){let __=wp.i18n.__}function wbpoll_formsubmit($element,$){var $submit_btn=$element.find(".wbpoll_vote_btn"),wrapper=$element.closest(".wbpoll_wrapper"),$_this_busy=Number($submit_btn.attr("data-busy")),user_answer=($submit_btn.attr("data-post-id"),$submit_btn.attr("data-reference"),$submit_btn.attr("data-charttype"),$submit_btn.attr("data-security"),$element.find("input.wbpoll_single_answer:checked").serialize());0===$_this_busy&&($submit_btn.attr("data-busy","1"),$submit_btn.prop("disabled",!0),wrapper.find(".wbvoteajaximage").removeClass("wbvoteajaximagecustom"),$_this_busy=user_answer.trim(),void 0!==user_answer&&0!==$_this_busy.length?(wrapper.find(".wbpoll-qresponse").hide(),$.ajax({type:"post",dataType:"json",url:wbpollpublic.ajaxurl,data:$element.serialize()+"&user_answer="+$.base64.btoa(user_answer),success:function(data,textStatus,XMLHttpRequest){if(0===Number(data.error))try{1===data.show_result&&wrapper.append(data.html),wrapper.find(".wbpoll-qresponse").show(),wrapper.find(".wbpoll-qresponse").removeClass("wbpoll-qresponse-alert wbpoll-qresponse-error wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").addClass("wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").html("<p>"+data.text+"</p>"),wrapper.find(".wbpoll_answer_wrapper").hide()}catch(e){}else wrapper.find(".wbpoll-qresponse").show(),wrapper.find(".wbpoll-qresponse").removeClass("wbpoll-qresponse-alert wbpoll-qresponse-error wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").addClass("wbpoll-qresponse-error"),wrapper.find(".wbpoll-qresponse").html("<p>"+data.text+"</p>");$submit_btn.attr("data-busy","0"),$submit_btn.prop("disabled",!1),wrapper.find(".wbvoteajaximage").addClass("wbvoteajaximagecustom")}})):($submit_btn.show(),$submit_btn.attr("data-busy",0),$submit_btn.prop("disabled",!1),wrapper.find(".wbvoteajaximage").addClass("wbvoteajaximagecustom"),$_this_busy=wbpollpublic.no_answer_error,wrapper.find(".wbpoll-qresponse").show(),wrapper.find(".wbpoll-qresponse").removeClass("wbpoll-qresponse-alert wbpoll-qresponse-error wbpoll-qresponse-success"),wrapper.find(".wbpoll-qresponse").addClass("wbpoll-qresponse-alert"),wrapper.find(".wbpoll-qresponse").html($_this_busy)))}jQuery(document).ready(function($){$.base64.utf8encode=!0,$(document.body).on("click",".wbpoll-listing-trig",function(e){e.preventDefault();var $this=$(this),parent=$this.closest(".wbpoll-listing-wrap"),e=Number($this.attr("data-busy")),page_no=Number($this.attr("data-page-no")),per_page=Number($this.attr("data-per-page")),nonce=$this.attr("data-security"),user_id=Number($this.attr("data-user_id"));0===Number(e)&&($this.attr("data-busy",1),$this.find(".wbvoteajaximage").removeClass("wbvoteajaximagecustom"),$.ajax({type:"post",dataType:"json",url:wbpollpublic.ajaxurl,data:{action:"wbpoll_list_pagination",page_no:page_no,per_page:per_page,security:nonce,user_id:user_id},success:function(data,textStatus,XMLHttpRequest){var content;$this.attr("data-busy",0),data.found&&(content=data.content,parent.find(".wbpoll-listing").append(content)),page_no!==data.max_num_pages&&0!==data.found||$this.parent(".wbpoll-listing-more").remove(),page_no++,$this.attr("data-page-no",page_no),$this.find(".wbvoteajaximage").addClass("wbvoteajaximagecustom")}}))}),$(document.body).on("submit",".wbpoll-form",function(e){e.preventDefault();var $element=$(this);new Pristine($element[0],{classTo:"wbpoll_extra_field_wrap",errorClass:"has-danger",successClass:"has-success",errorTextParent:"wbpoll_extra_field_wrap",errorTextTag:"p",errorTextClass:"text-help"}).validate()?wbpoll_formsubmit($element,$):e.preventDefault()}),$(".wbpoll-guest-wrap").on("click",".wbpoll-title-login a",function(e){e.preventDefault(),$(this).closest(".wbpoll-guest-wrap").find(".wbpoll-guest-login-wrap").toggle()})});