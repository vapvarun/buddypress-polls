if("undefined"!=typeof wp&&wp.i18n){let __=wp.i18n.__}($=>{var bpollsChartInstances={};function renderPollChart(canvasId,dataItems,title){var ctx=document.getElementById(canvasId),arr_label=[],arr_per=[],arr_color=[];$.each(dataItems,function(i,item){var truncatedLabel=20<item.label.length?item.label.substring(0,20)+"â€¦":item.label;arr_label.push(truncatedLabel),arr_per.push(item.y.toString()),arr_color.push(item.color)}),bpollsChartInstances[canvasId]&&bpollsChartInstances[canvasId].destroy(),bpollsChartInstances[canvasId]=new Chart(ctx,{type:"pie",data:{labels:arr_label,datasets:[{label:"Poll Activity Graph (%)",backgroundColor:arr_color,data:arr_per}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{animateScale:!0,animateRotate:!0},plugins:{title:{display:!0,text:title},tooltip:{callbacks:{label:function(context){var index=context.dataIndex;return dataItems[index].label+": "+context.formattedValue+"%"}}},legend:{position:"bottom",labels:{boxWidth:12}}}}})}window.onload=function(){var res=JSON.parse(bpolls_wiget_obj.votes);$(".poll-bar-chart, .poll-activity-chart").each(function(){var $canvas=$(this),act_id=$canvas.data("id"),$canvas=$canvas.attr("id");res[act_id]&&renderPollChart($canvas,res[act_id],res[act_id][0].poll_title)})},$(document).on("change",".bpolls-activities-list",function(){var data,$select=$(this),actid=$select.val();actid&&(data={action:"bpolls_activity_graph_ajax",actid:actid,ajax_nonce:bpolls_wiget_obj.ajax_nonce},$.post(bpolls_wiget_obj.ajax_url,data,function(response){var canvasId,response=JSON.parse(response);response[actid]&&($select.parents().siblings(".poll-bar-chart").remove(),$('<canvas class="poll-bar-chart" data-id="'+actid+'" id="'+(canvasId="bpolls-activity-chart-"+actid)+'"></canvas>').insertAfter($select.parents(".bpolls-activity-select")),renderPollChart(canvasId,response[actid],response[actid][0].poll_title))}))}),$(document).ready(function(){$(document).on("change",".bpolls-activities-list",function(e){e.preventDefault();e=$(this).val();e&&$("#export-poll-data").attr("href","?export_csv=1&buddypress_poll=1&activity_id="+e+"&_wpnonce="+bpolls_wiget_obj.export_csv_nonce)})})})(jQuery);