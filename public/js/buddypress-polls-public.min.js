if("undefined"!=typeof wp&&wp.i18n){let __=wp.i18n.__}($=>{jQuery(document).ready(function(){var bb_polls_Interval;function bb_pools_icon_push(){bb_polls_Interval=setInterval(function(){bpolls_ajax_object.buddyboss&&0==$("#whats-new-form:not(.focus-in) #whats-new-toolbar .bpolls-html-container-placeholder").length&&$("#whats-new-form:not(.focus-in) #whats-new-toolbar").append('<div class="post-elements-buttons-item bpolls-html-container-placeholder"><span class="bpolls-icon bp-tooltip" data-bp-tooltip-pos="up" data-bp-tooltip="'+bpolls_ajax_object.add_poll_text+'"><i class="wb-icons wb-icon-bar-chart"></i></span></div>')},10)}$("form#whats-new-form").attr("enctype","multipart/form-data"),bpolls_ajax_object.reign_polls&&document.body.classList.add("reign-polls"),bpolls_ajax_object.rt_poll_fix&&bpolls_ajax_object.nouveau&&($(document).on("click",".bpolls-icon",function(){$("#rtmedia-add-media-button-post-update").hide()}),$(document).on("click",".bpolls-cancel",function(){$("#rtmedia-add-media-button-post-update").show()}),$(document).on("focus","#whats-new",function(){$("#rtmedia-add-media-button-post-update").is(":hidden")&&$("#rtmedia-add-media-button-post-update").show()}),$(document).on("click","#rtmedia-add-media-button-post-update",function(){}),$(document).on("focus","#whats-new",function(){$(".bpolls-html-container").is(":hidden")&&$(".bpolls-html-container").show()})),$(document).on("click focus","#whats-new",function(){bpolls_ajax_object.buddyboss&&($("#whats-new-toolbar").append($(".bpolls-html-container")),$("#whats-new-attachments").append($(".bpolls-polls-option-html")),0==$(".whats-new-form-footer #whats-new-toolbar .bpolls-html-container").length)&&$(".bpolls-html-container").appendTo($(".whats-new-form-footer #whats-new-toolbar"))}),bpolls_ajax_object.buddyboss&&"yes"!=bpolls_ajax_object.hide_poll_icon&&bpolls_ajax_object.allowed_polls&&(bb_pools_icon_push(),$(document).on("click",".bb-model-close-button, .activity-update-form-overlay",function(){clearInterval(bb_polls_Interval),bb_pools_icon_push()}),$.ajaxPrefilter(function(options,originalOptions,jqXHR){try{if(null==originalOptions.data||void 0===originalOptions.data||void 0===originalOptions.data.action)return!0}catch(e){return!0}"post_update"==originalOptions.data.action&&(clearInterval(bb_polls_Interval),bb_pools_icon_push())})),$(document).on("focus","#whats-new",function(){$("#whats-new-options").addClass("bpolls-rtm-class")}),$(document).on("click",".bpolls-icon-dialog-cancel",function(){$(".bpolls-icon-dialog").removeClass("is-visible")}),$(document).on("click",".bpolls-add-option",function(){var max_options=bpolls_ajax_object.polls_option_lmit;$(this).parents(".bpolls-polls-option-html").find(".bpolls-option").length>=max_options?$(".bpolls-icon-dialog").addClass("is-visible"):((max_options=$(this).parent().siblings().find(".bpolls-option:first").clone().insertAfter($(this).parent().siblings().find(".bpolls-option:last"))).find("input").each(function(){this.value="",this.placeholder=""}),0==max_options.length&&$(this).parents(".bpolls-polls-option-html").find(".bpolls-sortable").html('<div class="bpolls-option">'+option_html+"</div>"))}),$(document).on("click",".bpolls-option-delete",function(){$(this).parent(".bpolls-option").remove()}),$(document).on("click",".bpolls-icon",function(){0!=$(".quote-btn").length&&($(".bg-type-input").val(""),$(".bg-type-value").val(""),$("#whats-new, #bppfa-whats-new").removeClass("quotesimg-bg-selected"),$("#whats-new, #bppfa-whats-new").removeClass("quotescolors-bg-selected"),$("#whats-new, #bppfa-whats-new").css("background-image",""),$("#whats-new, #bppfa-whats-new").css("background",""),$("#whats-new, #bppfa-whats-new").css("color",""),$(".bpquotes-selection").css("pointerEvents","auto")),0!=$(".bpchk-allow-checkin").length&&("undefined"!=typeof bpchk_public_js_obj&&$.ajax({dataType:"JSON",url:bpchk_public_js_obj.ajaxurl,type:"POST",data:{action:"bpchk_cancel_checkin"},success:function(response){$(".bpchk-checkin-temp-location").remove()}}),$("#bpchk-autocomplete-place").val(""),$("#bpchk-checkin-place-lat").val(""),$("#bpchk-checkin-place-lng").val(""),"undefined"!=typeof BPCHKPRO)&&(BPCHKPRO.delete_cookie("bpchkpro_lat"),BPCHKPRO.delete_cookie("bpchkpro_lng"),BPCHKPRO.delete_cookie("bpchkpro_place"),BPCHKPRO.delete_cookie("add_place")),$(".bpolls-polls-option-html").slideToggle(500),$(".bpolls-datetimepicker").datetimepicker(),$(".bpolls-polls-option-html").html(),$(".bpolls-option").html();$(function(){$(".bpolls-sortable").sortable({handle:".bpolls-sortable-handle"}),$(".bpolls-sortable").disableSelection()})}),$(document).on("click",".bpolls-cancel",function(){$("#aw-whats-new-reset").trigger("click"),$(".bpolls-input").each(function(){$(this).val("")}),$(".bpolls-polls-option-html").html(void 0),$(".bpolls-polls-option-html").slideUp(500),$(".bpolls-sortable").sortable({handle:".bpolls-sortable-handle"}),$(".bpolls-sortable").disableSelection()}),$(document).on("change","input.bpolls_input_options",function(){var poll_option=[],data=($("input.bpolls_input_options").each(function(){$(this).val()&&poll_option.push($(this).val())}),{action:"bpolls_set_poll_type_true",poll_option:poll_option,is_poll:0!==poll_option.length?"yes":"no",ajax_nonce:bpolls_ajax_object.ajax_nonce});$.post(bpolls_ajax_object.ajax_url,data,function(response){console.log(response)})}),$("#aw-whats-new-submit").click(function(){$(".bpolls-polls-option-html").html(void 0),$(".bpolls-polls-option-html").is(":visible")&&$(".bpolls-polls-option-html").slideToggle(500)}),$(document).on("click",".bpolls-vote-submit",function(e){e.preventDefault();for(var submit_event=$(this),e=$(this).html(),s_array=$(this).closest(".bpolls-vote-submit-form").serializeArray(),len=s_array.length,dataObj={},i=0;i<len;i++)dataObj[s_array[i].name]=s_array[i].value;var bpoll_activity_id=dataObj.bpoll_activity_id;null==dataObj["bpolls_vote_optn[]"]?submit_event.html(bpolls_ajax_object.optn_empty_text+' <i class="fa fa-exclamation-triangle"></i>'):(submit_event.html(e),submit_event.html(bpolls_ajax_object.submit_text+' <i class="fa fa-refresh fa-spin"></i>'),e={action:"bpolls_save_poll_vote",poll_data:$(this).closest(".bpolls-vote-submit-form").serialize(),ajax_nonce:bpolls_ajax_object.ajax_nonce},$.post(bpolls_ajax_object.ajax_url,e,function(response){response=JSON.parse(response);""!=response.bpolls_thankyou_feedback&&submit_event.after('<span class="bpolls-feedback-message">'+response.bpolls_thankyou_feedback+"</span>"),$.each(response,function(i,item){i=submit_event.closest(".bpolls-vote-submit-form").find("#"+i);$(i).parents(".bpolls-item").find(".bpolls-item-width").animate({width:item.vote_percent},500),$(i).parents(".bpolls-item").find(".bpolls-percent").text(item.vote_percent),$(i).parents(".bpolls-check-radio-div").siblings(".bpolls-votes").html(item.bpolls_votes_txt),$(i).parents().parents(".bpolls-item").find(".bpolls-result-votes").html(item.bpolls_votes_content)}),$("#activity-"+bpoll_activity_id+" .bpolls-item input").hide(),$("#activity-"+bpoll_activity_id+" .bpolls-add-user-item").remove(),submit_event.remove()}))}),$("#whats-new,#bppfa-whats-new").focus(function(){jQuery(".bpolls-icon").click(function(){jQuery(".bpquotes-bg-selection-div").hide(),jQuery(".bp-checkin-panel").hide()})}),$(document).on("click",".bp-polls-view-all",function(e){e.preventDefault();e={action:"bpolls_activity_all_voters",activity_id:$(this).data("activity-id"),option_id:$(this).data("option-id"),ajax_nonce:bpolls_ajax_object.ajax_nonce};$.post(bpolls_ajax_object.ajax_url,e,function(response){$("body").append(response.data)})}),$(document).on("click",".bpolls-modal-close.bpolls-modal-close-icon",function(e){$(".bpolls-icon-dialog.bpolls-user-votes-dialog").remove()}),$(document).on("keydown",".bpoll-add-user-option",function(e){var user_option,bpoll_activity_id,bpoll_user_id,user_count,add_option;13==e.keyCode&&""==$(this).val()&&(e.preventDefault(),bpoll_activity_id=$(this).data("activity-id"),$("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").show(),setTimeout(function(){$("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").hide(500)},5e3)),13==e.keyCode&&""!=$(this).val()&&(e.preventDefault(),e=bpolls_ajax_object.polls_option_lmit,user_option=$(this).val(),bpoll_activity_id=$(this).data("activity-id"),bpoll_user_id=$(this).data("user-id"),user_count=1,$("#activity-"+bpoll_activity_id+" .bpolls-item .bpolls-delete-user-option").each(function(){bpoll_user_id==$(this).data("user-id")&&user_count++}),e<user_count?(console.log(e+" =="+user_count),$(".bpolls-icon-dialog").addClass("is-visible")):(e={action:"bpolls_activity_add_user_option",activity_id:bpoll_activity_id,user_option:user_option,ajax_nonce:bpolls_ajax_object.ajax_nonce},add_option=$(this).parent(),$.post(bpolls_ajax_object.ajax_url,e,function(response){""!==(response=$.parseJSON(response)).add_poll_option&&($(response.add_poll_option).insertBefore(add_option),"yes"!=bpolls_ajax_object.poll_revoting)&&$("#activity-"+bpoll_activity_id+" .bpolls-vote-submit").trigger("click")}),$(this).val("")))}),$(document).on("click",".bpoll-add-option",function(e){e.preventDefault();var bpoll_user_id,user_count,add_option,e=bpolls_ajax_object.polls_option_lmit,bpoll_activity_id=$(this).data("activity-id"),user_option=$("#activity-"+bpoll_activity_id+" .bpoll-add-user-option").val();""!=user_option?(bpoll_user_id=$(this).data("user-id"),user_count=1,$("#activity-"+bpoll_activity_id+" .bpolls-item .bpolls-delete-user-option").each(function(){bpoll_user_id==$(this).data("user-id")&&user_count++}),e<user_count?(console.log(e+" =="+user_count),$(".bpolls-icon-dialog").addClass("is-visible")):(e={action:"bpolls_activity_add_user_option",activity_id:bpoll_activity_id,user_option:user_option,ajax_nonce:bpolls_ajax_object.ajax_nonce},add_option=$(this).parent(),$.post(bpolls_ajax_object.ajax_url,e,function(response){""!==(response=$.parseJSON(response)).add_poll_option&&($(response.add_poll_option).insertBefore(add_option),"yes"!=bpolls_ajax_object.poll_revoting)&&$("#activity-"+bpoll_activity_id+" .bpolls-vote-submit").trigger("click")}),$("#activity-"+bpoll_activity_id+" .bpoll-add-user-option").val(""))):($("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").attr("style","background-color: transparent !important; color: red !important;").show(),setTimeout(function(){$("#activity-"+bpoll_activity_id+" .bpolls-add-option-error").hide(500)},5e3))}),$(document).on("click",".bpolls-delete-user-option",function(e){var bpoll_activity_id,submit_event;e.preventDefault(),1==confirm(bpolls_ajax_object.delete_polls_msg)&&(e=$(this).data("option"),e={action:"bpolls_activity_delete_user_option",activity_id:bpoll_activity_id=$(this).data("activity-id"),user_option:e,ajax_nonce:bpolls_ajax_object.ajax_nonce},submit_event=$("#activity-"+bpoll_activity_id+" .bpolls-vote-submit"),$(this).closest(".bpolls-item").remove(),$.post(bpolls_ajax_object.ajax_url,e,function(response){console.log(response);response=JSON.parse(response);$.each(response,function(i,item){i=submit_event.closest(".bpolls-vote-submit-form").find("#"+i);$(i).parents(".bpolls-item").find(".bpolls-item-width").animate({width:item.vote_percent},500),$(i).parents(".bpolls-item").find(".bpolls-percent").text(item.vote_percent),$(i).parents(".bpolls-check-radio-div").siblings(".bpolls-votes").html(item.bpolls_votes_txt),$(i).parents().parents(".bpolls-item").find(".bpolls-result-votes").html(item.bpolls_votes_content)})}))})})})(jQuery),($=>{$(document).ready(function(){var file_frame;$(document).on("click","#bpolls-attach-image",function(event){event.preventDefault(),file_frame?file_frame.open():((file_frame=wp.media.frames.file_frame=wp.media({title:$(this).data("uploader_title"),button:{text:$(this).data("uploader_button_text")},multiple:!1,library:{author:bpolls_ajax_object.poll_user}})).on("select",function(){var data;attachment=file_frame.state().get("selection").first().toJSON(),$("#bpolls-image-preview").attr("src",attachment.url),attachment.url&&(data={action:"bpolls_save_image",image_url:attachment.url,ajax_nonce:bpolls_ajax_object.ajax_nonce},$.post(bpolls_ajax_object.ajax_url,data,function(response){}))}),file_frame.open(),$(".media-router button:first-child").click())})})})(jQuery);